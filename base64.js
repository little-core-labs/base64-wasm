
module.exports = loadWebAssembly

loadWebAssembly.supported = typeof WebAssembly !== 'undefined'

function loadWebAssembly (opts) {
  if (!loadWebAssembly.supported) return null

  var imp = opts && opts.imports
  var wasm = toUint8Array('AGFzbQEAAAABGwVgA39/fwF/YAJ/fwBgAABgAX8Bf2ACf38BfwIPAQNlbnYGbWVtb3J5AgACAwoJAgAAAAMBBAABBjcJfwFB0IgEC38AQcAIC38AQcQIC38AQYAIC38AQcgIC38AQYAIC38AQdCIBAt/AEEAC38AQQELB6oCERFfX3dhc21fY2FsbF9jdG9ycwAADWJhc2U2NF9lbmNvZGUAAxZiYXNlNjRfZW5jb2RpbmdfbGVuZ3RoAAQTYmFzZTY0X2VuY29kZV9ibG9jawAFFmJhc2U2NF9kZWNvZGluZ19sZW5ndGgABg1iYXNlNjRfZGVjb2RlAAcTYmFzZTY0X2RlY29kZV9ibG9jawAIFV9fenpfc3ltYm9sX25hbWVzX2xlbgMBEV9fenpfc3ltYm9sX25hbWVzAwIGbWVtY3B5AAIGbWVtc2V0AAEMX19kc29faGFuZGxlAwMKX19kYXRhX2VuZAMEDV9fZ2xvYmFsX2Jhc2UDBQtfX2hlYXBfYmFzZQMGDV9fbWVtb3J5X2Jhc2UDBwxfX3RhYmxlX2Jhc2UDCAqKHAkDAAEL/AICAn8BfgJAIAJFDQAgACABOgAAIAAgAmoiA0F/aiABOgAAIAJBA0kNACAAIAE6AAIgACABOgABIANBfWogAToAACADQX5qIAE6AAAgAkEHSQ0AIAAgAToAAyADQXxqIAE6AAAgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDACABQRhqIAU3AwAgAUEQaiAFNwMAIAFBCGogBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAAC5ALAQh/AkAgAkUgAUEDcUVyRQRAIAAhAwNAIAMgAS0AADoAACACQX9qIQQgA0EBaiEDIAFBAWohASACQQFGDQIgBCECIAFBA3ENAAsMAQsgAiEEIAAhAwsCQCADQQNxIgJFBEACQCAEQRBJBEAgBCECDAELIARBcGohAgNAIAMgASgCADYCACADQQRqIAFBBGooAgA2AgAgA0EIaiABQQhqKAIANgIAIANBDGogAUEMaigCADYCACADQRBqIQMgAUEQaiEBIARBcGoiBEEPSw0ACwsgAkEIcQRAIAMgASkCADcCACADQQhqIQMgAUEIaiEBCyACQQRxBEAgAyABKAIANgIAIANBBGohAyABQQRqIQELIAJBAnEEQCADIAEtAAA6AAAgAyABLQABOgABIANBAmohAyABQQJqIQELIAJBAXFFDQEgAyABLQAAOgAAIAAPCwJAIARBIEkNACACQX9qIgJBAksNAAJAAkACQCACQQFrDgIBAgALIAMgAS0AAToAASADIAEoAgAiBToAACADIAEtAAI6AAIgBEF9aiEIIANBA2ohCSAEQWxqQXBxIQpBACECA0AgAiAJaiIDIAEgAmoiBkEEaigCACIHQQh0IAVBGHZyNgIAIANBBGogBkEIaigCACIFQQh0IAdBGHZyNgIAIANBCGogBkEMaigCACIHQQh0IAVBGHZyNgIAIANBDGogBkEQaigCACIFQQh0IAdBGHZyNgIAIAJBEGohAiAIQXBqIghBEEsNAAsgAiAJaiEDIAEgAmpBA2ohASAEIAprQW1qIQQMAgsgAyABKAIAIgU6AAAgAyABLQABOgABIARBfmohCCADQQJqIQkgBEFsakFwcSEKQQAhAgNAIAIgCWoiAyABIAJqIgZBBGooAgAiB0EQdCAFQRB2cjYCACADQQRqIAZBCGooAgAiBUEQdCAHQRB2cjYCACADQQhqIAZBDGooAgAiB0EQdCAFQRB2cjYCACADQQxqIAZBEGooAgAiBUEQdCAHQRB2cjYCACACQRBqIQIgCEFwaiIIQRFLDQALIAIgCWohAyABIAJqQQJqIQEgBCAKa0FuaiEEDAELIAMgASgCACIFOgAAIARBf2ohCCADQQFqIQkgBEFsakFwcSEKQQAhAgNAIAIgCWoiAyABIAJqIgZBBGooAgAiB0EYdCAFQQh2cjYCACADQQRqIAZBCGooAgAiBUEYdCAHQQh2cjYCACADQQhqIAZBDGooAgAiB0EYdCAFQQh2cjYCACADQQxqIAZBEGooAgAiBUEYdCAHQQh2cjYCACACQRBqIQIg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')
  var ready = null

  var mod = {
    buffer: wasm,
    memory: null,
    exports: null,
    realloc: realloc,
    onload: onload
  }

  onload(function () {})

  return mod

  function realloc (size) {
    mod.exports.memory.grow(Math.max(0, Math.ceil(Math.abs(size - mod.memory.length) / 65536)))
    mod.memory = new Uint8Array(mod.exports.memory.buffer)
  }

  function onload (cb) {
    if (mod.exports) return cb()

    if (ready) {
      ready.then(cb.bind(null, null)).catch(cb)
      return
    }

    try {
      if (opts && opts.async) throw new Error('async')
      setup({instance: new WebAssembly.Instance(new WebAssembly.Module(wasm), imp)})
    } catch (err) {
      ready = WebAssembly.instantiate(wasm, imp).then(setup)
    }

    onload(cb)
  }

  function setup (w) {
    mod.exports = w.instance.exports
    mod.memory = mod.exports.memory && mod.exports.memory.buffer && new Uint8Array(mod.exports.memory.buffer)
  }
}

function toUint8Array (s) {
  if (typeof atob === 'function') return new Uint8Array(atob(s).split('').map(charCodeAt))
  return (require('buf' + 'fer').Buffer).from(s, 'base64')
}

function charCodeAt (c) {
  return c.charCodeAt(0)
}
